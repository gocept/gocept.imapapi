============
IMAP Folders
============

Retrieving IMAP folders
=======================

IMAP accounts provide access to the folder structure by exposing the top-level
folders:

>>> from gocept.imapapi.account import Account
>>> account = Account('localhost', 10143, 'test', 'bsdf')
>>> account.folders()
[<gocept.imapapi.folder.Folder object 'Bar' at 0x...>,
 <gocept.imapapi.folder.Folder object 'INBOX' at 0x...>]

A folder knows about its name, path, separator, and depth in the hierarchy:

>>> INBOX = account.folders()[1]
>>> INBOX.name
'INBOX'
>>> INBOX.path
'INBOX'
>>> INBOX.separator
'/'
>>> INBOX.depth
1

Folders also provide access to their direct sub-folders:

>>> INBOX.folders()
[<gocept.imapapi.folder.Folder object 'INBOX/Baz' at 0x...>]

Here's a folder that's a bit deeper in the hierarchy:

>>> baz = INBOX.folders()[0]
>>> baz.name
'Baz'
>>> baz.path
'INBOX/Baz'
>>> baz.separator
'/'
>>> baz.depth
2

Individual folders can be retrieved by specifying their name:

>>> INBOX.folders(name='Baz')
[<gocept.imapapi.folder.Folder object 'INBOX/Baz' at 0x...>]

>>> INBOX.folders(name='Qux')
[]

Creating folders
================

Folders may be created as top-level folders of an account or within existing
folders.

>>> top_level = account.create_folder('Top level')
>>> account.folders()
[<gocept.imapapi.folder.Folder object 'Bar' at 0x...>,
 <gocept.imapapi.folder.Folder object 'INBOX' at 0x...>,
 <gocept.imapapi.folder.Folder object 'Top level' at 0x...>]
>>> top_level.name
'Top level'
>>> top_level.path
'Top level'

>>> subfolder = top_level.create_folder('Subfolder')
>>> top_level.folders()
[<gocept.imapapi.folder.Folder object 'Top level/Subfolder' at 0x...>]
>>> subfolder.name
'Subfolder'
>>> subfolder.path
'Top level/Subfolder'


Retrieving messages
===================

Messages can be retrieved from the folder using the `messages` method. If we
give no parameters, we will retrieve all messages:

>>> INBOX.messages()
[<gocept.imapapi.message.Message object 'INBOX/...' at 0x...>,
 <gocept.imapapi.message.Message object 'INBOX/...' at 0x...>]

Individual messages have a name attribute which can be used to uniquely
identify a message within a folder. We can use it to retrieve an individual
message.

>>> mail1 = INBOX.messages()[0]
>>> mail1.headers['X-IMAPAPI-Test']
u'1'
>>> INBOX.messages(name=mail1.name)[0].headers['X-IMAPAPI-Test']
u'1'
